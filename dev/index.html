<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chart Preview - Development</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: #1a1a2e;
        color: #eee;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
      }

      h1 {
        margin-bottom: 20px;
        color: #fff;
      }

      .demo-container {
        max-width: 800px;
        width: 100%;
      }

      .file-inputs {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-bottom: 20px;
        padding: 20px;
        background: #16213e;
        border-radius: 8px;
      }

      .chart-picker {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
      }

      .chart-picker button {
        flex-shrink: 0;
      }

      .chart-info {
        display: none;
        padding: 12px;
        background: #0f3460;
        border-radius: 6px;
        margin-top: 10px;
      }

      .chart-info.visible {
        display: block;
      }

      .chart-info h3 {
        font-size: 16px;
        margin-bottom: 8px;
        color: #3498db;
      }

      .chart-info p {
        font-size: 13px;
        color: #aaa;
        margin-bottom: 4px;
      }

      .chart-info .song-name {
        font-size: 18px;
        font-weight: 600;
        color: #fff;
      }

      .chart-info .artist {
        font-size: 14px;
        color: #ccc;
      }

      .last-chart-hint {
        display: none;
        font-size: 12px;
        color: #888;
        margin-top: 5px;
      }

      .last-chart-hint.visible {
        display: block;
      }

      .file-input-group {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      label {
        font-weight: 600;
        font-size: 14px;
        color: #aaa;
      }

      input[type="file"] {
        display: none;
      }

      .options {
        display: none;
        gap: 15px;
        flex-wrap: wrap;
        padding-top: 15px;
        border-top: 1px solid #1a4b8c;
      }

      .options.visible {
        display: flex;
      }

      select {
        padding: 8px 12px;
        background: #0f3460;
        border: 1px solid #1a4b8c;
        border-radius: 4px;
        color: #eee;
        font-size: 14px;
        min-width: 150px;
      }

      select:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .preview-wrapper {
        background: #000;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 20px;
      }

      /* Web Component player container */
      chart-preview-player {
        display: block;
        width: 100%;
        height: 400px;
      }

      button {
        padding: 10px 20px;
        background: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: background 0.2s;
      }

      button:hover:not(:disabled) {
        background: #2980b9;
      }

      button:disabled {
        background: #555;
        cursor: not-allowed;
      }

      button.secondary {
        background: #0f3460;
        border: 1px solid #1a4b8c;
      }

      button.secondary:hover:not(:disabled) {
        background: #1a4b8c;
      }

      .status {
        padding: 10px;
        margin-top: 15px;
        background: #16213e;
        border-radius: 4px;
        font-size: 13px;
        color: #aaa;
      }

      .status.error {
        background: #3d1515;
        color: #e74c3c;
      }

      .status.success {
        background: #153d15;
        color: #2ecc71;
      }

      .player-events {
        margin-top: 15px;
        padding: 10px;
        background: #16213e;
        border-radius: 4px;
        font-size: 12px;
        font-family: monospace;
        color: #888;
        max-height: 100px;
        overflow-y: auto;
      }

      .player-events .event {
        padding: 2px 0;
      }

      .player-events .event.state {
        color: #3498db;
      }

      .player-events .event.progress {
        color: #666;
      }

      .player-events .event.end {
        color: #2ecc71;
      }

      .player-events .event.error {
        color: #e74c3c;
      }
    </style>
  </head>
  <body>
    <div class="demo-container">
      <div class="file-inputs">
        <div class="file-input-group">
          <label>Select Chart</label>
          <div class="chart-picker">
            <button id="choose-folder-btn">Choose Chart Folder</button>
            <button id="choose-sng-btn" class="secondary">
              Choose .sng File
            </button>
            <input type="file" id="folder-input" webkitdirectory />
            <input type="file" id="sng-input" accept=".sng" />
          </div>
          <div class="last-chart-hint" id="last-chart-hint">
            Last used: <span id="last-chart-name"></span>
          </div>
        </div>

        <div class="chart-info" id="chart-info">
          <p class="song-name" id="song-name">Song Name</p>
          <p class="artist" id="song-artist">Artist</p>
          <p id="song-charter"></p>
          <p id="song-length"></p>
        </div>

        <div class="options" id="track-options">
          <div class="file-input-group">
            <label>Instrument</label>
            <select id="instrument" disabled>
              <option value="">Select chart first...</option>
            </select>
          </div>
          <div class="file-input-group">
            <label>Difficulty</label>
            <select id="difficulty" disabled>
              <option value="">Select instrument first...</option>
            </select>
          </div>
        </div>
        <button id="load-btn" disabled>Load Preview</button>
      </div>

      <div class="preview-wrapper">
        <chart-preview-player id="player" volume="50"></chart-preview-player>
      </div>

      <div class="status" id="status">
        Choose a chart folder or .sng file to begin.
      </div>

      <div class="player-events" id="player-events">
        <div class="event">Player events will appear here...</div>
      </div>
    </div>

    <script type="module" src="./main.ts"></script>
  </body>
</html>
